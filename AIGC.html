<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>AIGC.html</title>
  <meta name="generator" content="Haroopad 0.13.1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>div.oembedall-githubrepos{border:1px solid #DDD;border-radius:4px;list-style-type:none;margin:0 0 10px;padding:8px 10px 0;font:13.34px/1.4 helvetica,arial,freesans,clean,sans-serif;width:452px;background-color:#fff}div.oembedall-githubrepos .oembedall-body{background:-moz-linear-gradient(center top,#FAFAFA,#EFEFEF);background:-webkit-gradient(linear,left top,left bottom,from(#FAFAFA),to(#EFEFEF));border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-top:1px solid #EEE;margin-left:-10px;margin-top:8px;padding:5px 10px;width:100%}div.oembedall-githubrepos h3{font-size:14px;margin:0;padding-left:18px;white-space:nowrap}div.oembedall-githubrepos p.oembedall-description{color:#444;font-size:12px;margin:0 0 3px}div.oembedall-githubrepos p.oembedall-updated-at{color:#888;font-size:11px;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats{border:none;float:right;font-size:11px;font-weight:700;padding-left:15px;position:relative;z-index:5;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats li{border:none;color:#666;display:inline-block;list-style-type:none;margin:0!important}div.oembedall-githubrepos ul.oembedall-repo-stats li a{background-color:transparent;border:none;color:#666!important;background-position:5px -2px;background-repeat:no-repeat;border-left:1px solid #DDD;display:inline-block;height:21px;line-height:21px;padding:0 5px 0 23px}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a{border-left:medium none;margin-right:-3px}div.oembedall-githubrepos ul.oembedall-repo-stats li a:hover{background:5px -27px no-repeat #4183C4;color:#FFF!important;text-decoration:none}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a:hover{border-bottom-left-radius:3px;border-top-left-radius:3px}ul.oembedall-repo-stats li:last-child a:hover{border-bottom-right-radius:3px;border-top-right-radius:3px}span.oembedall-closehide{background-color:#aaa;border-radius:2px;cursor:pointer;margin-right:3px}div.oembedall-container{margin-top:5px;text-align:left}.oembedall-ljuser{font-weight:700}.oembedall-ljuser img{vertical-align:bottom;border:0;padding-right:1px}.oembedall-stoqembed{border-bottom:1px dotted #999;float:left;overflow:hidden;width:730px;line-height:1;background:#FFF;color:#000;font-family:Arial,Liberation Sans,DejaVu Sans,sans-serif;font-size:80%;text-align:left;margin:0;padding:0}.oembedall-stoqembed a{color:#07C;text-decoration:none;margin:0;padding:0}.oembedall-stoqembed a:hover{text-decoration:underline}.oembedall-stoqembed a:visited{color:#4A6B82}.oembedall-stoqembed h3{font-family:Trebuchet MS,Liberation Sans,DejaVu Sans,sans-serif;font-size:130%;font-weight:700;margin:0;padding:0}.oembedall-stoqembed .oembedall-reputation-score{color:#444;font-size:120%;font-weight:700;margin-right:2px}.oembedall-stoqembed .oembedall-user-info{height:35px;width:185px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-gravatar32{float:left;height:32px;width:32px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-details{float:left;margin-left:5px;overflow:hidden;white-space:nowrap;width:145px}.oembedall-stoqembed .oembedall-question-hyperlink{font-weight:700}.oembedall-stoqembed .oembedall-stats{background:#EEE;margin:0 0 0 7px;padding:4px 7px 6px;width:58px}.oembedall-stoqembed .oembedall-statscontainer{float:left;margin-right:8px;width:86px}.oembedall-stoqembed .oembedall-votes{color:#555;padding:0 0 7px;text-align:center}.oembedall-stoqembed .oembedall-vote-count-post{font-size:240%;color:#808185;display:block;font-weight:700}.oembedall-stoqembed .oembedall-views{color:#999;padding-top:4px;text-align:center}.oembedall-stoqembed .oembedall-status{margin-top:-3px;padding:4px 0;text-align:center;background:#75845C;color:#FFF}.oembedall-stoqembed .oembedall-status strong{color:#FFF;display:block;font-size:140%}.oembedall-stoqembed .oembedall-summary{float:left;width:635px}.oembedall-stoqembed .oembedall-excerpt{line-height:1.2;margin:0;padding:0 0 5px}.oembedall-stoqembed .oembedall-tags{float:left;line-height:18px}.oembedall-stoqembed .oembedall-tags a:hover{text-decoration:none}.oembedall-stoqembed .oembedall-post-tag{background-color:#E0EAF1;border-bottom:1px solid #3E6D8E;border-right:1px solid #7F9FB6;color:#3E6D8E;font-size:90%;line-height:2.4;margin:2px 2px 2px 0;padding:3px 4px;text-decoration:none;white-space:nowrap}.oembedall-stoqembed .oembedall-post-tag:hover{background-color:#3E6D8E;border-bottom:1px solid #37607D;border-right:1px solid #37607D;color:#E0EAF1}.oembedall-stoqembed .oembedall-fr{float:right}.oembedall-stoqembed .oembedall-statsarrow{background-image:url(http://cdn.sstatic.net/stackoverflow/img/sprites.png?v=3);background-repeat:no-repeat;overflow:hidden;background-position:0 -435px;float:right;height:13px;margin-top:12px;width:7px}.oembedall-facebook1{border:1px solid #1A3C6C;padding:0;font:13.34px/1.4 verdana;width:500px}.oembedall-facebook2{background-color:#627add}.oembedall-facebook2 a{color:#e8e8e8;text-decoration:none}.oembedall-facebookBody{background-color:#fff;vertical-align:top;padding:5px}.oembedall-facebookBody .contents{display:inline-block;width:100%}.oembedall-facebookBody div img{float:left;margin-right:5px}div.oembedall-lanyard{-webkit-box-shadow:none;-webkit-transition-delay:0s;-webkit-transition-duration:.4000000059604645s;-webkit-transition-property:width;-webkit-transition-timing-function:cubic-bezier(0.42,0,.58,1);background-attachment:scroll;background-clip:border-box;background-color:transparent;background-image:none;background-origin:padding-box;border-width:0;box-shadow:none;color:#112644;display:block;float:left;font-family:'Trebuchet MS',Trebuchet,sans-serif;font-size:16px;height:253px;line-height:19px;margin:0;max-width:none;min-height:0;outline:#112644 0;overflow-x:visible;overflow-y:visible;padding:0;position:relative;text-align:left;vertical-align:baseline;width:804px}div.oembedall-lanyard .tagline{font-size:1.5em}div.oembedall-lanyard .wrapper{overflow:hidden;clear:both}div.oembedall-lanyard .split{float:left;display:inline}div.oembedall-lanyard .prominent-place .flag:active,div.oembedall-lanyard .prominent-place .flag:focus,div.oembedall-lanyard .prominent-place .flag:hover,div.oembedall-lanyard .prominent-place .flag:link,div.oembedall-lanyard .prominent-place .flag:visited{float:left;display:block;width:48px;height:48px;position:relative;top:-5px;margin-right:10px}div.oembedall-lanyard .place-context{font-size:.889em}div.oembedall-lanyard .prominent-place .sub-place{display:block}div.oembedall-lanyard .prominent-place{font-size:1.125em;line-height:1.1em;font-weight:400}div.oembedall-lanyard .main-date{color:#8CB4E0;font-weight:700;line-height:1.1}div.oembedall-lanyard .first{width:48.57%;margin:0 0 0 2.857%}.mermaid .label{color:#333}.node circle,.node polygon,.node rect{fill:#cde498;stroke:#13540c;stroke-width:1px}.edgePath .path{stroke:green;stroke-width:1.5px}.cluster rect{fill:#cdffb2;rx:40;stroke:#6eaa49;stroke-width:1px}.cluster text{fill:#333}.actor{stroke:#13540c;fill:#cde498}text.actor{fill:#000;stroke:none}.actor-line{stroke:grey}.messageLine0{stroke-width:1.5;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#333}.messageLine1{stroke-width:1.5;stroke-dasharray:"2 2";stroke:#333}#arrowhead{fill:#333}#crosshead path{fill:#333!important;stroke:#333!important}.messageText{fill:#333;stroke:none}.labelBox{stroke:#326932;fill:#cde498}.labelText,.loopText{fill:#000;stroke:none}.loopLine{stroke-width:2;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#326932}.note{stroke:#6eaa49;fill:#fff5ad}.noteText{fill:#000;stroke:none;font-family:'trebuchet ms',verdana,arial;font-size:14px}.section{stroke:none;opacity:.2}.section0,.section2{fill:#6eaa49}.section1,.section3{fill:#fff;opacity:.2}.sectionTitle0,.sectionTitle1,.sectionTitle2,.sectionTitle3{fill:#333}.sectionTitle{text-anchor:start;font-size:11px;text-height:14px}.grid .tick{stroke:lightgrey;opacity:.3;shape-rendering:crispEdges}.grid path{stroke-width:0}.today{fill:none;stroke:red;stroke-width:2px}.task{stroke-width:2}.taskText{text-anchor:middle;font-size:11px}.taskTextOutsideRight{fill:#000;text-anchor:start;font-size:11px}.taskTextOutsideLeft{fill:#000;text-anchor:end;font-size:11px}.taskText0,.taskText1,.taskText2,.taskText3{fill:#fff}.task0,.task1,.task2,.task3{fill:#487e3a;stroke:#13540c}.taskTextOutside0,.taskTextOutside1,.taskTextOutside2,.taskTextOutside3{fill:#000}.active0,.active1,.active2,.active3{fill:#cde498;stroke:#13540c}.activeText0,.activeText1,.activeText2,.activeText3{fill:#000!important}.done0,.done1,.done2,.done3{stroke:grey;fill:lightgrey;stroke-width:2}.doneText0,.doneText1,.doneText2,.doneText3{fill:#000!important}.crit0,.crit1,.crit2,.crit3{stroke:#f88;fill:red;stroke-width:2}.activeCrit0,.activeCrit1,.activeCrit2,.activeCrit3{stroke:#f88;fill:#cde498;stroke-width:2}.doneCrit0,.doneCrit1,.doneCrit2,.doneCrit3{stroke:#f88;fill:lightgrey;stroke-width:2;cursor:pointer;shape-rendering:crispEdges}.activeCritText0,.activeCritText1,.activeCritText2,.activeCritText3,.doneCritText0,.doneCritText1,.doneCritText2,.doneCritText3{fill:#000!important}.titleText{text-anchor:middle;font-size:18px;fill:#000}text{font-family:'trebuchet ms',verdana,arial;font-size:14px}html{height:100%}body{margin:0!important;padding:5px 20px 26px!important;background-color:#fff;font-family:"Lucida Grande","Segoe UI","Apple SD Gothic Neo","Malgun Gothic","Lucida Sans Unicode",Helvetica,Arial,sans-serif;font-size:.9em;overflow-x:hidden;overflow-y:auto}br,h1,h2,h3,h4,h5,h6{clear:both}hr.page{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x;border:0;height:3px;padding:0}hr.underscore{border-top-style:dashed!important}body >:first-child{margin-top:0!important}img.plugin{box-shadow:0 1px 3px rgba(0,0,0,.1);border-radius:3px}iframe{border:0}figure{-webkit-margin-before:0;-webkit-margin-after:0;-webkit-margin-start:0;-webkit-margin-end:0}kbd{border:1px solid #aaa;-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;-moz-box-shadow:1px 2px 2px #ddd;-webkit-box-shadow:1px 2px 2px #ddd;box-shadow:1px 2px 2px #ddd;background-color:#f9f9f9;background-image:-moz-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-o-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-webkit-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:linear-gradient(top,#eee,#f9f9f9,#eee);padding:1px 3px;font-family:inherit;font-size:.85em}.oembeded .oembed_photo{display:inline-block}img[data-echo]{margin:25px 0;width:100px;height:100px;background:url(../img/ajax.gif) center center no-repeat #fff}.spinner{display:inline-block;width:10px;height:10px;margin-bottom:-.1em;border:2px solid rgba(0,0,0,.5);border-top-color:transparent;border-radius:100%;-webkit-animation:spin 1s infinite linear;animation:spin 1s infinite linear}.spinner:after{content:'';display:block;width:0;height:0;position:absolute;top:-6px;left:0;border:4px solid transparent;border-bottom-color:rgba(0,0,0,.5);-webkit-transform:rotate(45deg);transform:rotate(45deg)}@-webkit-keyframes spin{to{-webkit-transform:rotate(360deg)}}@keyframes spin{to{transform:rotate(360deg)}}p.toc{margin:0!important}p.toc ul{padding-left:10px}p.toc>ul{padding:10px;margin:0 10px;display:inline-block;border:1px solid #ededed;border-radius:5px}p.toc li,p.toc ul{list-style-type:none}p.toc li{width:100%;padding:0;overflow:hidden}p.toc li a::after{content:"."}p.toc li a:before{content:"• "}p.toc h5{text-transform:uppercase}p.toc .title{float:left;padding-right:3px}p.toc .number{margin:0;float:right;padding-left:3px;background:#fff;display:none}input.task-list-item{margin-left:-1.62em}.markdown{font-family:"Hiragino Sans GB","Microsoft YaHei",STHeiti,SimSun,"Lucida Grande","Lucida Sans Unicode","Lucida Sans",'Segoe UI',AppleSDGothicNeo-Medium,'Malgun Gothic',Verdana,Tahoma,sans-serif;padding:20px}.markdown a{text-decoration:none;vertical-align:baseline}.markdown a:hover{text-decoration:underline}.markdown h1{font-size:2.2em;font-weight:700;margin:1.5em 0 1em}.markdown h2{font-size:1.8em;font-weight:700;margin:1.275em 0 .85em}.markdown h3{font-size:1.6em;font-weight:700;margin:1.125em 0 .75em}.markdown h4{font-size:1.4em;font-weight:700;margin:.99em 0 .66em}.markdown h5{font-size:1.2em;font-weight:700;margin:.855em 0 .57em}.markdown h6{font-size:1em;font-weight:700;margin:.75em 0 .5em}.markdown h1+p,.markdown h1:first-child,.markdown h2+p,.markdown h2:first-child,.markdown h3+p,.markdown h3:first-child,.markdown h4+p,.markdown h4:first-child,.markdown h5+p,.markdown h5:first-child,.markdown h6+p,.markdown h6:first-child{margin-top:0}.markdown hr{border:1px solid #ccc}.markdown p{margin:1em 0;word-wrap:break-word}.markdown ol{list-style-type:decimal}.markdown li{display:list-item;line-height:1.4em}.markdown blockquote{margin:1em 20px}.markdown blockquote>:first-child{margin-top:0}.markdown blockquote>:last-child{margin-bottom:0}.markdown blockquote cite:before{content:'\2014 \00A0'}.markdown .code{border-radius:3px;word-wrap:break-word}.markdown pre{border-radius:3px;word-wrap:break-word;border:1px solid #ccc;overflow:auto;padding:.5em}.markdown pre code{border:0;display:block}.markdown pre>code{font-family:Consolas,Inconsolata,Courier,monospace;font-weight:700;white-space:pre;margin:0}.markdown code{border-radius:3px;word-wrap:break-word;border:1px solid #ccc;padding:0 5px;margin:0 2px}.markdown img{max-width:100%}.markdown mark{color:#000;background-color:#fcf8e3}.markdown table{padding:0;border-collapse:collapse;border-spacing:0;margin-bottom:16px}.markdown table tr td,.markdown table tr th{border:1px solid #ccc;margin:0;padding:6px 13px}.markdown table tr th{font-weight:700}.markdown table tr th>:first-child{margin-top:0}.markdown table tr th>:last-child{margin-bottom:0}.markdown table tr td>:first-child{margin-top:0}.markdown table tr td>:last-child{margin-bottom:0}.github{padding:20px;font-family:"Helvetica Neue",Helvetica,"Hiragino Sans GB","Microsoft YaHei",STHeiti,SimSun,"Segoe UI",AppleSDGothicNeo-Medium,'Malgun Gothic',Arial,freesans,sans-serif;font-size:15px;background:#fff;line-height:1.6;-webkit-font-smoothing:antialiased}.github a{color:#3269a0}.github a:hover{color:#4183c4}.github h2{border-bottom:1px solid #e6e6e6;line-height:1.6}.github h6{color:#777}.github hr{border:1px solid #e6e6e6}.github pre>code{font-size:.9em;font-family:Consolas,Inconsolata,Courier,monospace}.github blockquote>code,.github h1>code,.github h2>code,.github h3>code,.github h4>code,.github h5>code,.github h6>code,.github li>code,.github p>code,.github td>code{background-color:rgba(0,0,0,.07);font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;font-size:85%;padding:.2em .5em;border:0}.github blockquote{border-left:4px solid #e6e6e6;padding:0 15px;font-style:italic}.github table{background-color:#fafafa}.github table tr td,.github table tr th{border:1px solid #e6e6e6}.github table tr:nth-child(2n){background-color:#f2f2f2}.hljs{display:block;overflow-x:auto;padding:.5em;background:#23241f;-webkit-text-size-adjust:none}.aspectj .hljs-function,.css .hljs-function .hljs-preprocessor,.css .hljs-rules,.css .hljs-value,.hljs,.hljs-pragma,.hljs-tag{color:#f8f8f2}.hljs-emphasis,.hljs-strong,.hljs-strongemphasis{color:#a8a8a2}.alias .hljs-keyword,.hljs-blockquote,.hljs-bullet,.hljs-hexcolor,.hljs-horizontal_rule,.hljs-literal,.hljs-number,.hljs-regexp{color:#ae81ff}.css .hljs-class,.hljs-class .hljs-title:last-child,.hljs-code,.hljs-tag .hljs-value,.hljs-title{color:#a6e22e}.hljs-link_url{font-size:80%}.hljs-strong,.hljs-strongemphasis{font-weight:700}.hljs-class .hljs-title:last-child,.hljs-emphasis,.hljs-strongemphasis,.hljs-typename{font-style:italic}.alias .hljs-keyword:first-child,.css .hljs-important,.css .hljs-tag,.css .unit,.hljs-attribute,.hljs-change,.hljs-flow,.hljs-function,.hljs-header,.hljs-keyword,.hljs-symbol,.hljs-symbol .hljs-string,.hljs-tag .hljs-title,.hljs-value,.hljs-winutils,.nginx .hljs-title,.ruby .hljs-class .hljs-keyword:first-child,.ruby .hljs-function .hljs-keyword,.tex .hljs-special{color:#f92672}.css .hljs-attribute,.hljs-aspect .hljs-keyword:first-child,.hljs-class .hljs-keyword:first-child,.hljs-constant,.hljs-function .hljs-keyword,.hljs-typename{color:#66d9ef}.hljs-aspect .hljs-title,.hljs-class .hljs-title,.hljs-params,.hljs-variable{color:#f8f8f2}.apache .hljs-cbracket,.apache .hljs-tag,.css .hljs-id,.django .hljs-filter .hljs-argument,.django .hljs-template_tag,.django .hljs-variable,.hljs-addition,.hljs-attr_selector,.hljs-built_in,.hljs-envvar,.hljs-link_label,.hljs-link_url,.hljs-prompt,.hljs-pseudo,.hljs-stream,.hljs-string,.hljs-subst,.hljs-type,.ruby .hljs-class .hljs-parent,.smalltalk .hljs-array,.smalltalk .hljs-class,.smalltalk .hljs-localvars,.tex .hljs-command{color:#e6db74}.apache .hljs-sqbracket,.hljs-annotation,.hljs-comment,.hljs-decorator,.hljs-deletion,.hljs-doctype,.hljs-javadoc,.hljs-pi,.hljs-shebang,.tex .hljs-formula{color:#75715e}.coffeescript .javascript,.javascript .xml,.php .xml,.tex .hljs-formula,.xml .css,.xml .hljs-cdata,.xml .javascript,.xml .php,.xml .vbscript{opacity:.5}.MathJax_Hover_Frame{border-radius:.25em;-webkit-border-radius:.25em;-moz-border-radius:.25em;-khtml-border-radius:.25em;box-shadow:0 0 15px #83A;-webkit-box-shadow:0 0 15px #83A;-moz-box-shadow:0 0 15px #83A;-khtml-box-shadow:0 0 15px #83A;border:1px solid #A6D!important;display:inline-block;position:absolute}.MathJax_Hover_Arrow{position:absolute;width:15px;height:11px;cursor:pointer}#MathJax_About{position:fixed;left:50%;width:auto;text-align:center;border:3px outset;padding:1em 2em;background-color:#DDD;color:#000;cursor:default;font-family:message-box;font-size:120%;font-style:normal;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;border-radius:15px;-webkit-border-radius:15px;-moz-border-radius:15px;-khtml-border-radius:15px;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_Menu{position:absolute;background-color:#fff;color:#000;width:auto;padding:2px;border:1px solid #CCC;margin:0;cursor:default;font:menu;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_MenuItem{padding:2px 2em;background:0 0}.MathJax_MenuArrow{position:absolute;right:.5em;color:#666}.MathJax_MenuActive .MathJax_MenuArrow{color:#fff}.MathJax_MenuArrow.RTL{left:.5em;right:auto}.MathJax_MenuCheck{position:absolute;left:.7em}.MathJax_MenuCheck.RTL{right:.7em;left:auto}.MathJax_MenuRadioCheck{position:absolute;left:1em}.MathJax_MenuRadioCheck.RTL{right:1em;left:auto}.MathJax_MenuLabel{padding:2px 2em 4px 1.33em;font-style:italic}.MathJax_MenuRule{border-top:1px solid #CCC;margin:4px 1px 0}.MathJax_MenuDisabled{color:GrayText}.MathJax_MenuActive{background-color:Highlight;color:HighlightText}.MathJax_Menu_Close{position:absolute;width:31px;height:31px;top:-15px;left:-15px}#MathJax_Zoom{position:absolute;background-color:#F0F0F0;overflow:auto;display:block;z-index:301;padding:.5em;border:1px solid #000;margin:0;font-weight:400;font-style:normal;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;box-shadow:5px 5px 15px #AAA;-webkit-box-shadow:5px 5px 15px #AAA;-moz-box-shadow:5px 5px 15px #AAA;-khtml-box-shadow:5px 5px 15px #AAA;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}#MathJax_ZoomOverlay{position:absolute;left:0;top:0;z-index:300;display:inline-block;width:100%;height:100%;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}#MathJax_ZoomFrame{position:relative;display:inline-block;height:0;width:0}#MathJax_ZoomEventTrap{position:absolute;left:0;top:0;z-index:302;display:inline-block;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}.MathJax_Preview{color:#888}#MathJax_Message{position:fixed;left:1px;bottom:2px;background-color:#E6E6E6;border:1px solid #959595;margin:0;padding:2px 8px;z-index:102;color:#000;font-size:80%;width:auto;white-space:nowrap}#MathJax_MSIE_Frame{position:absolute;top:0;left:0;width:0;z-index:101;border:0;margin:0;padding:0}.MathJax_Error{color:#C00;font-style:italic}.MathJax_Display{text-align:center;margin:1em 0;position:relative;display:block!important;text-indent:0;max-width:none;max-height:none;min-width:0;min-height:0;width:100%}.MathJax .merror{background-color:#FF8;color:#C00;border:1px solid #C00;padding:1px 3px;font-style:normal;font-size:90%}.MathJax .MJX-monospace{font-family:monospace}.MathJax .MJX-sans-serif{font-family:sans-serif}#MathJax_Tooltip{background-color:InfoBackground;color:InfoText;border:1px solid #000;box-shadow:2px 2px 5px #AAA;-webkit-box-shadow:2px 2px 5px #AAA;-moz-box-shadow:2px 2px 5px #AAA;-khtml-box-shadow:2px 2px 5px #AAA;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true');padding:3px 4px;z-index:401;position:absolute;left:0;top:0;width:auto;height:auto;display:none}.MathJax{display:inline;font-style:normal;font-weight:400;line-height:normal;font-size:100%;font-size-adjust:none;text-indent:0;text-align:left;text-transform:none;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;direction:ltr;max-width:none;max-height:none;min-width:0;min-height:0;border:0;padding:0;margin:0}.MathJax a,.MathJax img,.MathJax nobr{border:0;padding:0;margin:0;max-width:5000em;max-height:5000em;min-width:0;min-height:0;vertical-align:0;line-height:normal;text-decoration:none}img.MathJax_strut{border:0!important;padding:0!important;margin:0!important;vertical-align:0!important}.MathJax span{display:inline;position:static;border:0;padding:0;margin:0;vertical-align:0;line-height:normal;text-decoration:none}.MathJax nobr{white-space:nowrap!important}.MathJax img{display:inline!important;float:none!important}.MathJax *{transition:none;-webkit-transition:none;-moz-transition:none;-ms-transition:none;-o-transition:none}.MathJax_Processing{visibility:hidden;position:fixed;width:0;height:0;overflow:hidden}.MathJax_Processed{display:none!important}.MathJax_ExBox{display:block!important;overflow:hidden;width:1px;height:60ex;min-height:0;max-height:none}.MathJax .MathJax_EmBox{display:block!important;overflow:hidden;width:1px;height:60em;min-height:0;max-height:none}.MathJax .MathJax_HitBox{cursor:text;background:#fff;opacity:0;filter:alpha(opacity=0)}#MathJax_Tooltip *,.MathJax .MathJax_HitBox *{filter:none;opacity:1;background:0 0}@font-face{font-family:MathJax_Main;src:url(file:///C:/software/markdown/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///C:/software/markdown/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?rev=2.4-beta-2) format('opentype')}@font-face{font-family:MathJax_Main;src:url(file:///C:/software/markdown/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?rev=2.4-beta-2) format('woff'),url(file:///C:/software/markdown/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?rev=2.4-beta-2) format('opentype');font-weight:700}@font-face{font-family:MathJax_Main;src:url(file:///C:/software/markdown/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?rev=2.4-beta-2) format('woff'),url(file:///C:/software/markdown/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?rev=2.4-beta-2) format('opentype');font-style:italic}@font-face{font-family:MathJax_Math;src:url(file:///C:/software/markdown/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?rev=2.4-beta-2) format('woff'),url(file:///C:/software/markdown/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?rev=2.4-beta-2) format('opentype');font-style:italic}@font-face{font-family:MathJax_Caligraphic;src:url(file:///C:/software/markdown/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///C:/software/markdown/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?rev=2.4-beta-2) format('opentype')}@font-face{font-family:MathJax_Size1;src:url(file:///C:/software/markdown/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///C:/software/markdown/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?rev=2.4-beta-2) format('opentype')}@font-face{font-family:MathJax_Size2;src:url(file:///C:/software/markdown/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///C:/software/markdown/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?rev=2.4-beta-2) format('opentype')}@font-face{font-family:MathJax_Size3;src:url(file:///C:/software/markdown/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///C:/software/markdown/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?rev=2.4-beta-2) format('opentype')}@font-face{font-family:MathJax_Size4;src:url(file:///C:/software/markdown/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?rev=2.4-beta-2) format('woff'),url(file:///C:/software/markdown/Libraries/.js/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?rev=2.4-beta-2) format('opentype')}.MathJax .noError{font-size:90%;text-align:left;color:#000;padding:1px 3px;border:1px solid}footer{position:fixed;font-size:.8em;text-align:right;bottom:0;margin-left:-25px;height:20px;width:100%}</style>
</head>
<body class="markdown github">
<h3 id="1-目录"><a name="1-目录" href="#1-目录"></a>1 目录</h3><p class="toc" style="undefined"></p><ul>
<li><ul>
<li><ul>
<li><span class="title">
<a href="#1-目录" title="1 目录">1 目录</a>
</span>
<!--span class="number">
0
</span-->
</li>
<li><span class="title">
<a href="#2-大模型基础" title="2 大模型基础">2 大模型基础</a>
</span>
<!--span class="number">
1
</span-->
<ul>
<li><span class="title">
<a href="#2.1-构建框架" title="2.1 构建框架">2.1 构建框架</a>
</span>
<!--span class="number">
2
</span-->
</li>
<li><span class="title">
<a href="#2.2-预训练模型" title="2.2 预训练模型">2.2 预训练模型</a>
</span>
<!--span class="number">
3
</span-->
<ul>
<li><span class="title">
<a href="#2.2.1-数据" title="2.2.1 数据">2.2.1 数据</a>
</span>
<!--span class="number">
4
</span-->
</li>
<li><span class="title">
<a href="#2.2.2-文本分词" title="2.2.2 文本分词">2.2.2 文本分词</a>
</span>
<!--span class="number">
5
</span-->
</li>
<li><span class="title">
<a href="#2.2.3-bert" title="2.2.3 Bert">2.2.3 Bert</a>
</span>
<!--span class="number">
6
</span-->
</li>
<li><span class="title">
<a href="#2.2.4-gpt" title="2.2.4 GPT">2.2.4 GPT</a>
</span>
<!--span class="number">
7
</span-->
</li>
<li><span class="title">
<a href="#2.2.5-bart" title="2.2.5 BART">2.2.5 BART</a>
</span>
<!--span class="number">
8
</span-->
</li>
<li><span class="title">
<a href="#2.2.6-t5" title="2.2.6 T5">2.2.6 T5</a>
</span>
<!--span class="number">
9
</span-->
</li>
<li><span class="title">
<a href="#2.2.7-unilm" title="2.2.7 Unilm">2.2.7 Unilm</a>
</span>
<!--span class="number">
10
</span-->
</li>
<li><span class="title">
<a href="#2.2.8-glm" title="2.2.8 GLM">2.2.8 GLM</a>
</span>
<!--span class="number">
11
</span-->
</li>
<li><span class="title">
<a href="#2.2.9-llama" title="2.2.9 LLaMA">2.2.9 LLaMA</a>
</span>
<!--span class="number">
12
</span-->
</li>
</ul>
</li>
</ul>
</li>
<li><span class="title">
<a href="#2.3-有监督微调" title="2.3 有监督微调">2.3 有监督微调</a>
</span>
<!--span class="number">
13
</span-->
<ul>
<li><ul>
<li><span class="title">
<a href="#2.3.1-bitfit" title="2.3.1 BitFit">2.3.1 BitFit</a>
</span>
<!--span class="number">
14
</span-->
</li>
</ul>
</li>
<li><span class="title">
<a href="#2.3.2-prompt-tuning" title="2.3.2 Prompt-Tuning">2.3.2 Prompt-Tuning</a>
</span>
<!--span class="number">
15
</span-->
</li>
<li><span class="title">
<a href="#2.3.3-p-tuning" title="2.3.3 P-Tuning">2.3.3 P-Tuning</a>
</span>
<!--span class="number">
16
</span-->
</li>
<li><span class="title">
<a href="#2.3.4-prefix-tuning" title="2.3.4 Prefix-Tuning">2.3.4 Prefix-Tuning</a>
</span>
<!--span class="number">
17
</span-->
</li>
<li><span class="title">
<a href="#2.3.5-lora" title="2.3.5 Lora">2.3.5 Lora</a>
</span>
<!--span class="number">
18
</span-->
</li>
<li><span class="title">
<a href="#2.3.6-ia3" title="2.3.6 IA3">2.3.6 IA3</a>
</span>
<!--span class="number">
19
</span-->
</li>
<li><span class="title">
<a href="#2.3.7-adapter" title="2.3.7 Adapter">2.3.7 Adapter</a>
</span>
<!--span class="number">
20
</span-->
</li>
</ul>
</li>
<li><span class="title">
<a href="#2.4-强化学习" title="2.4 强化学习">2.4 强化学习</a>
</span>
<!--span class="number">
21
</span-->
<ul>
<li><span class="title">
<a href="#2.4.1-奖励模型" title="2.4.1 奖励模型">2.4.1 奖励模型</a>
</span>
<!--span class="number">
22
</span-->
</li>
<li><span class="title">
<a href="#2.4.2-rlhf" title="2.4.2 RLHF">2.4.2 RLHF</a>
</span>
<!--span class="number">
23
</span-->
</li>
</ul>
</li>
</ul>
</li>
<li><span class="title">
<a href="#3-多模态" title="3 多模态">3 多模态</a>
</span>
<!--span class="number">
24
</span-->
<ul>
<li><span class="title">
<a href="#3.1-数据" title="3.1 数据">3.1 数据</a>
</span>
<!--span class="number">
25
</span-->
</li>
<li><span class="title">
<a href="#3.2-多模态模型" title="3.2 多模态模型">3.2 多模态模型</a>
</span>
<!--span class="number">
26
</span-->
<ul>
<li><span class="title">
<a href="#3.2.1-clip" title="3.2.1 CLIP">3.2.1 CLIP</a>
</span>
<!--span class="number">
27
</span-->
</li>
<li><span class="title">
<a href="#3.2.2-stable-diffusion" title="3.2.2 Stable Diffusion">3.2.2 Stable Diffusion</a>
</span>
<!--span class="number">
28
</span-->
</li>
<li><span class="title">
<a href="#3.2.3-controlnet" title="3.2.3 ControlNet">3.2.3 ControlNet</a>
</span>
<!--span class="number">
29
</span-->
</li>
<li><span class="title">
<a href="#3.2.4-imagen" title="3.2.4 Imagen">3.2.4 Imagen</a>
</span>
<!--span class="number">
30
</span-->
</li>
<li><span class="title">
<a href="#3.2.5-dreambooth" title="3.2.5 Dreambooth">3.2.5 Dreambooth</a>
</span>
<!--span class="number">
31
</span-->
</li>
</ul>
</li>
</ul>
</li>
<li><span class="title">
<a href="#4-分布式训练" title="4 分布式训练">4 分布式训练</a>
</span>
<!--span class="number">
32
</span-->
<ul>
<li><span class="title">
<a href="#4.1-概述" title="4.1 概述">4.1 概述</a>
</span>
<!--span class="number">
33
</span-->
</li>
<li><span class="title">
<a href="#4.2-并行策略" title="4.2 并行策略">4.2 并行策略</a>
</span>
<!--span class="number">
34
</span-->
<ul>
<li><span class="title">
<a href="#4.2.1-数据并行" title="4.2.1 数据并行">4.2.1 数据并行</a>
</span>
<!--span class="number">
35
</span-->
</li>
<li><span class="title">
<a href="#4.2.1-模型并行" title="4.2.1 模型并行">4.2.1 模型并行</a>
</span>
<!--span class="number">
36
</span-->
</li>
<li><span class="title">
<a href="#4.2.1-张量并行" title="4.2.1 张量并行">4.2.1 张量并行</a>
</span>
<!--span class="number">
37
</span-->
</li>
</ul>
</li>
<li><span class="title">
<a href="#4.3-deepspeed" title="4.3 DeepSpeed">4.3 DeepSpeed</a>
</span>
<!--span class="number">
38
</span-->
</li>
</ul>
</li>
<li><span class="title">
<a href="#5-大模型应用框架" title="5 大模型应用框架">5 大模型应用框架</a>
</span>
<!--span class="number">
39
</span-->
</li>
<li><span class="title">
<a href="#6-nlp-任务" title="6 NLP 任务">6 NLP 任务</a>
</span>
<!--span class="number">
40
</span-->
</li>
<li><span class="title">
<a href="#7-视觉" title="7 视觉">7 视觉</a>
</span>
<!--span class="number">
41
</span-->
</li>
</ul>
</li>

</ul>
<p></p><h3 id="2-大模型基础"><a name="2-大模型基础" href="#2-大模型基础"></a>2 大模型基础</h3><h4 id="2.1-构建框架"><a name="2.1-构建框架" href="#2.1-构建框架"></a>2.1 构建框架</h4><p><img src="pic/2-1.png" alt="大模型框架图" title="大模型框架图"></p><h4 id="2.2-预训练模型"><a name="2.2-预训练模型" href="#2.2-预训练模型"></a>2.2 预训练模型</h4><h5 id="2.2.1-数据"><a name="2.2.1-数据" href="#2.2.1-数据"></a>2.2.1 数据</h5><h5 id="2.2.2-文本分词"><a name="2.2.2-文本分词" href="#2.2.2-文本分词"></a>2.2.2 文本分词</h5><ul>
<li>分词类性：<ul>
<li>word 分词， OOV问题</li><li>character分词，过长，失去了单词的联系</li><li>Subword：<br>“unfortunately” = “un” + “for” + “tun” + “ate” + “ly”<br>常用算法：BPE，SentencePiece，WordPiece等</li></ul>
</li><li>BPE：<br>Byte-Pair Encoding。先拆分为character, 然后统计token pair频率，合并， GPT</li><li>WordPiece：<br>与BPE 很相近，过程类似，但是会考虑单个token的频率，如果单个token的频率很高，也不会合并。如un-able， un 和 able 概率都很高，即使un-able pair很高，也不会合并</li><li>Unigram：<br>从一个巨大的词汇表出发，再逐渐删除trimdown其中的词汇，直到size满足预定义。初始的词汇表可以采用所有预分词器分出来的词，再加上所有高频的子串。每次从词汇表中删除词汇的原则是使预定义的损失最小。<br>训练文档所有词为<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-116-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-1180" style="width: 7.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.222em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.873em 1000em 3.083em -0.465em); top: -2.722em; left: 0em;"><span class="mrow" id="MathJax-Span-1181"><span class="msubsup" id="MathJax-Span-1182"><span style="display: inline-block; position: relative; width: 1.075em; height: 0px;"><span style="position: absolute; clip: rect(1.891em 1000em 2.678em -0.465em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-1183" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.128em; left: 0.611em;"><span class="mn" id="MathJax-Span-1184" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span></span><span class="mo" id="MathJax-Span-1185" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1186" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.075em; height: 0px;"><span style="position: absolute; clip: rect(1.891em 1000em 2.678em -0.465em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-1187" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.128em; left: 0.611em;"><span class="mn" id="MathJax-Span-1188" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span></span><span class="mo" id="MathJax-Span-1189" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-1190" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-1191" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-1192" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-1193" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-1194" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.384em; height: 0px;"><span style="position: absolute; clip: rect(1.65em 1000em 2.667em -0.474em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-1195" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.128em; left: 0.865em;"><span class="mi" id="MathJax-Span-1196" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.722em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.186em; vertical-align: -0.299em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-116">x_1, x_2, ..., X_n</script></span>, 每个词token的方法是一个集合<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-117-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-1197" style="width: 2.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.389em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.806em 1000em 3.139em -0.448em); top: -2.722em; left: 0em;"><span class="mrow" id="MathJax-Span-1198"><span class="mi" id="MathJax-Span-1199" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-1200" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1201"><span style="display: inline-block; position: relative; width: 0.964em; height: 0px;"><span style="position: absolute; clip: rect(1.891em 1000em 2.678em -0.465em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-1202" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.128em; left: 0.611em;"><span class="mi" id="MathJax-Span-1203" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span></span><span class="mo" id="MathJax-Span-1204" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.722em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.333em; vertical-align: -0.367em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-117">S(x_i)</script></span>, 当一个词汇表确定时，每个词tokenize的方法集合<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-118-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-1205" style="width: 2.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.389em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.806em 1000em 3.139em -0.448em); top: -2.722em; left: 0em;"><span class="mrow" id="MathJax-Span-1206"><span class="mi" id="MathJax-Span-1207" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span><span class="mo" id="MathJax-Span-1208" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1209"><span style="display: inline-block; position: relative; width: 0.964em; height: 0px;"><span style="position: absolute; clip: rect(1.891em 1000em 2.678em -0.465em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-1210" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.128em; left: 0.611em;"><span class="mi" id="MathJax-Span-1211" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span></span><span class="mo" id="MathJax-Span-1212" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.722em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.333em; vertical-align: -0.367em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-118">S(x_i)</script></span> 就是确定的，每种方法对应一个概率<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-119-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-1213" style="width: 2.55em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.111em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.806em 1000em 3.139em -0.467em); top: -2.722em; left: 0em;"><span class="mrow" id="MathJax-Span-1214"><span class="mi" id="MathJax-Span-1215" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-1216" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1217" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1218" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.722em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.333em; vertical-align: -0.367em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-119">P(x)</script></span>, 依据损失进行删除。</li><li>SentencePiece：<br>把一个句子看作一个整体，再拆成片段，而没有保留天然的词语的概念。一般地，它把空格space也当作一种特殊字符来处理，再用BPE或者Unigram算法来构造词汇表。与Unigram算法联合使用</li></ul><h5 id="2.2.3-bert"><a name="2.2.3-bert" href="#2.2.3-bert"></a>2.2.3 Bert</h5><pre><code data-origin="<pre><code>    BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding
    https://arxiv.org/pdf/1810.04805.pdf
</code></pre>">    BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding
    https://arxiv.org/pdf/1810.04805.pdf
</code></pre><ul>
<li>pretrain:<ul>
<li>Masked LM</li><li>Next Sentence Prediction</li></ul>
</li></ul><p><img src="pic/2/bert.jpg" alt="Bert" title="Bert"><br><img src="pic/2/bert-2.jpg" alt="Bert-2" title="Bert-2"></p><h5 id="2.2.4-gpt"><a name="2.2.4-gpt" href="#2.2.4-gpt"></a>2.2.4 GPT</h5><pre><code data-origin="<pre><code>GPT1：Improving Language Understanding by Generative Pre-Training
https://www.cs.ubc.ca/~amuham01/LING530/papers/radford2018improving.pdf
GPT2：Language Models are Unsupervised Multitask Learners
https://d4mucfpksywv.cloudfront.net/better-language-models/language-models.pdf
GPT3：Language Models are Few-Shot Learners
https://arxiv.org/pdf/2005.14165.pdf
InstructGPT：Training language models to follow instructions with human feedback
https://arxiv.org/pdf/2203.02155.pdf
</code></pre>">GPT1：Improving Language Understanding by Generative Pre-Training
https://www.cs.ubc.ca/~amuham01/LING530/papers/radford2018improving.pdf
GPT2：Language Models are Unsupervised Multitask Learners
https://d4mucfpksywv.cloudfront.net/better-language-models/language-models.pdf
GPT3：Language Models are Few-Shot Learners
https://arxiv.org/pdf/2005.14165.pdf
InstructGPT：Training language models to follow instructions with human feedback
https://arxiv.org/pdf/2203.02155.pdf
</code></pre><ul>
<li><p>GPT1:<br><img src="pic/2/gpt1.jpg" alt="GPT1" title="GPT1"><br>自回归方式训练，预训练阶段窗口设置，需要主要的是fune-tuning时，损失函数包含预训练损失</p>
</li><li><p>GPT2：<br>  堆数据，堆网络参数，网络norm层有变化</p>
</li><li><p>GPT3：<br>  <img src="pic/2/gpt3.jpg" alt="GPT3" title="GPT3"><br>  模型使用spare attention, 175B参数</p>
</li><li><p>InstructGPT<br>  <img src="pic/2/gpt3.jpg" alt="GPT3" title="GPT3"></p>
</li></ul><h5 id="2.2.5-bart"><a name="2.2.5-bart" href="#2.2.5-bart"></a>2.2.5 BART</h5><pre><code data-origin="<pre><code>BART: Denoising Sequence-to-Sequence Pre-training for Natural Language Generation, Translation, and Comprehension
https://arxiv.org/pdf/1910.13461.pdf
</code></pre>">BART: Denoising Sequence-to-Sequence Pre-training for Natural Language Generation, Translation, and Comprehension
https://arxiv.org/pdf/1910.13461.pdf
</code></pre><p>  <img src="pic/2/bart.jpg" alt="BART1" title="BART1"> </p><ul>
<li>Pre-training:<ul>
<li>Token Masking</li><li>Token Deletion</li><li>Text Infilling</li><li>Sentence Permutation</li><li>Document Rotation</li></ul>
</li></ul><p><img src="pic/2/bart-2.jpg" alt="BART-2" title="BART-2"></p><ul>
<li><p>Fine-Tuning：<br>  在做machine translation时，先预训练参数，只更新initialized encoder参数，后完全更新参数。</p>
<p><img src="pic/2/bart-3.jpg" alt="BART-3" title="BART-3"></p>
</li></ul><h5 id="2.2.6-t5"><a name="2.2.6-t5" href="#2.2.6-t5"></a>2.2.6 T5</h5><pre><code data-origin="<pre><code>Exploring the Limits of Transfer Learning with a Unified Text-to-Text Transformer
https://arxiv.org/pdf/1910.10683.pdf
</code></pre>">Exploring the Limits of Transfer Learning with a Unified Text-to-Text Transformer
https://arxiv.org/pdf/1910.10683.pdf
</code></pre><p>   <img src="pic/2/t5.jpg" alt="t5" title="t5"><br>添加前缀</p><h5 id="2.2.7-unilm"><a name="2.2.7-unilm" href="#2.2.7-unilm"></a>2.2.7 Unilm</h5><pre><code data-origin="<pre><code>Unified Language Model Pre-training for Natural Language Understanding and Generation
https://arxiv.org/pdf/1905.03197.pdf
</code></pre>">Unified Language Model Pre-training for Natural Language Understanding and Generation
https://arxiv.org/pdf/1905.03197.pdf
</code></pre><h5 id="2.2.8-glm"><a name="2.2.8-glm" href="#2.2.8-glm"></a>2.2.8 GLM</h5><h5 id="2.2.9-llama"><a name="2.2.9-llama" href="#2.2.9-llama"></a>2.2.9 LLaMA</h5><pre><code data-origin="<pre><code>LLaMA: Open and Efficient Foundation Language Models
https://arxiv.org/pdf/2302.13971.pdf
Llama 2: Open Foundation and Fine-Tuned Chat Models
https://arxiv.org/pdf/2307.09288.pdf
</code></pre>">LLaMA: Open and Efficient Foundation Language Models
https://arxiv.org/pdf/2302.13971.pdf
Llama 2: Open Foundation and Fine-Tuned Chat Models
https://arxiv.org/pdf/2307.09288.pdf
</code></pre><ul>
<li><p>LLaMA-1：</p>
<ul>
<li>decoder only  </li><li>Pre-normalization</li><li>SwiGLU activation function</li><li>Rotary Embeddings</li></ul>
</li><li><p>LLaMA-2：</p>
</li></ul><h3 id="2.3-有监督微调"><a name="2.3-有监督微调" href="#2.3-有监督微调"></a>2.3 有监督微调</h3><p>有监督微调（Supervised Finetuning, SFT）又称指令微调（Instruction Tuning），是指在已经训练好的语言模型的基础上，通过使用有标注的特定任务数据进行进一步的微调，从而使得模型具备遵循指令的能力。经过海量数据预训练后的语言模型虽然具备了大量的“知识”，但是由于其训练时的目标仅是进行下一个词的预测，此时的模型还不能够理解并遵循人类自然语言形式的指令。</p><p><img src="pic/3-1.jpg" alt="有监督微调图" title="有监督微调图"></p><p>微调技术综述：</p><pre><code data-origin="<pre><code>Scaling Down to Scale Up: A Guide to Parameter-Efficient Fine-Tuning
https://arxiv.org/pdf/2303.15647.pdf
</code></pre>">Scaling Down to Scale Up: A Guide to Parameter-Efficient Fine-Tuning
https://arxiv.org/pdf/2303.15647.pdf
</code></pre><h5 id="2.3.1-bitfit"><a name="2.3.1-bitfit" href="#2.3.1-bitfit"></a>2.3.1 BitFit</h5><pre><code data-origin="<pre><code>只调节神经网络的bias参数
</code></pre>">只调节神经网络的bias参数
</code></pre><p><img src="pic/3/bitfit.png" alt="BitFit" title="BitFit"></p><p>论文：</p><pre><code data-origin="<pre><code>BitFit: Simple Parameter-efficient Fine-tuning for Transformer-based Masked Language-models
https://arxiv.org/pdf/2106.10199v2.pdf
</code></pre>">BitFit: Simple Parameter-efficient Fine-tuning for Transformer-based Masked Language-models
https://arxiv.org/pdf/2106.10199v2.pdf
</code></pre><p>代码：</p><pre><code data-origin="<pre><code>for name, param in model.named_parameters():
    if &quot;bias&quot; not in name:
        param.requires_grad = False
</code></pre>">for name, param in model.named_parameters():
    if "bias" not in name:
        param.requires_grad = False
</code></pre><h4 id="2.3.2-prompt-tuning"><a name="2.3.2-prompt-tuning" href="#2.3.2-prompt-tuning"></a>2.3.2 Prompt-Tuning</h4><p><img src="pic/3/prompt-tuning.png" alt="BitFit" title="BitFit"></p><p>论文：</p><pre><code data-origin="<pre><code>The Power of Scale for Parameter-Efficient Prompt Tuning
https://arxiv.org/pdf/2104.08691.pdf
</code></pre>">The Power of Scale for Parameter-Efficient Prompt Tuning
https://arxiv.org/pdf/2104.08691.pdf
</code></pre><p>算法原理：</p><p><span class="MathJax_Preview"></span></p><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-460-Frame"><nobr><span class="math" id="MathJax-Span-4919" style="width: 15.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.222em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.571em 1000em 3.246em -0.47em); top: -2.722em; left: 0em;"><span class="mrow" id="MathJax-Span-4920"><span class="texatom" id="MathJax-Span-4921"><span class="mrow" id="MathJax-Span-4922"><span class="munderover" id="MathJax-Span-4923"><span style="display: inline-block; position: relative; width: 0.782em; height: 0px;"><span style="position: absolute; clip: rect(1.65em 1000em 2.666em -0.47em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-4924" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; clip: rect(1.862em 1000em 2.358em -0.388em); top: -3.013em; left: 0.282em;"><span class="mo" id="MathJax-Span-4925" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 2.722em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-4926" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-4927" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">a</span><span class="mi" id="MathJax-Span-4928" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-4929" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-4930" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-4931" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="msubsup" id="MathJax-Span-4932"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(1.891em 1000em 2.678em -0.465em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-4933" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.128em; left: 0.611em;"><span class="mi" id="MathJax-Span-4934" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.129em;"></span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span></span><span class="mi" id="MathJax-Span-4935" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="msubsup" id="MathJax-Span-4936"><span style="display: inline-block; position: relative; width: 1.797em; height: 0px;"><span style="position: absolute; clip: rect(1.891em 1000em 2.678em -0.479em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-4937" style="font-family: MathJax_Math; font-style: italic;">r</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.124em; left: 0.5em;"><span class="texatom" id="MathJax-Span-4938"><span class="mrow" id="MathJax-Span-4939"><span class="mi" id="MathJax-Span-4940" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-4941" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-4942"><span style="display: inline-block; position: relative; width: 0.664em; height: 0px;"><span style="position: absolute; clip: rect(1.613em 1000em 2.452em -0.475em); top: -2.278em; left: 0em;"><span class="texatom" id="MathJax-Span-4943"><span class="mrow" id="MathJax-Span-4944"><span class="mi" id="MathJax-Span-4945" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span></span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span><span style="position: absolute; top: -2.061em; left: 0.333em;"><span class="mi" id="MathJax-Span-4946" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span></span><span class="mo" id="MathJax-Span-4947" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-4948" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="texatom" id="MathJax-Span-4949"><span class="mrow" id="MathJax-Span-4950"><span class="mo" id="MathJax-Span-4951" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-4952" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-4953" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-4954" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-4955" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-4956" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-4957" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.722em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.744em; vertical-align: -0.495em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-460">\hat{Y}=argmax_YPr_{\theta, {\theta}_p}(Y|[P;X])</script><p></p><ul>
<li><p><span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-461-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-4958" style="width: 0.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.5em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.628em 1000em 2.677em -0.465em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-4959"><span class="texatom" id="MathJax-Span-4960"><span class="mrow" id="MathJax-Span-4961"><span class="mi" id="MathJax-Span-4962" style="font-family: MathJax_Math; font-style: italic;">θ</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.991em; vertical-align: -0.079em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-461">{\theta}</script></span>  model parameters, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-462-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-4963" style="width: 1.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.295em 1000em 2.621em -0.465em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-4964"><span class="texatom" id="MathJax-Span-4965"><span class="mrow" id="MathJax-Span-4966"><span class="msubsup" id="MathJax-Span-4967"><span style="display: inline-block; position: relative; width: 0.964em; height: 0px;"><span style="position: absolute; clip: rect(1.628em 1000em 2.677em -0.465em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-4968" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.128em; left: 0.5em;"><span class="mi" id="MathJax-Span-4969" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.324em; vertical-align: -0.411em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-462">{\theta_p}</script></span> prompt 参数</p>
</li><li><p><span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-463-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-4970" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.778em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.65em 1000em 2.666em -0.47em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-4971"><span class="mi" id="MathJax-Span-4972" style="font-family: MathJax_Math; font-style: italic;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.952em; vertical-align: -0.065em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-463">Y</script></span> output, a sequence of tokens</p>
</li><li><p><span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-464-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-4973" style="width: 1.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.889em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.65em 1000em 2.667em -0.474em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-4974"><span class="mi" id="MathJax-Span-4975" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.953em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-464">X</script></span> input, a sequence of tokens</p>
</li><li><p><span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-465-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-4976" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.778em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.65em 1000em 2.667em -0.467em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-4977"><span class="mi" id="MathJax-Span-4978" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.953em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-465">P</script></span> prompt, a series of tokens prepended to the input </p>
</li></ul><p>当输入是<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-466-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-4979" style="width: 0.75em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.611em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.891em 1000em 2.678em -0.479em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-4980"><span class="mi" id="MathJax-Span-4981" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.677em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-466">n</script></span> 个tokens, 表示为<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-467-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-4982" style="width: 7.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.114em 1000em 3.083em -0.465em); top: -2.722em; left: 0em;"><span class="mrow" id="MathJax-Span-4983"><span class="texatom" id="MathJax-Span-4984"><span class="mrow" id="MathJax-Span-4985"><span class="msubsup" id="MathJax-Span-4986"><span style="display: inline-block; position: relative; width: 1.075em; height: 0px;"><span style="position: absolute; clip: rect(1.891em 1000em 2.678em -0.465em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-4987" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.128em; left: 0.611em;"><span class="mn" id="MathJax-Span-4988" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span></span><span class="mo" id="MathJax-Span-4989" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-4990" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.075em; height: 0px;"><span style="position: absolute; clip: rect(1.891em 1000em 2.678em -0.465em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-4991" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.128em; left: 0.611em;"><span class="mn" id="MathJax-Span-4992" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span></span><span class="mo" id="MathJax-Span-4993" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-4994" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-4995" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-4996" style="font-family: MathJax_Main; padding-left: 0.167em;">.</span><span class="mo" id="MathJax-Span-4997" style="font-family: MathJax_Main; padding-left: 0.167em;">,</span><span class="msubsup" id="MathJax-Span-4998" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.131em; height: 0px;"><span style="position: absolute; clip: rect(1.891em 1000em 2.678em -0.465em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-4999" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.128em; left: 0.611em;"><span class="mi" id="MathJax-Span-5000" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.722em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.897em; vertical-align: -0.299em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-467">{x_1, x_2,...,x_n}</script></span>, 模型会将这些input通过embedding层转换为一个矩阵<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-468-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-5001" style="width: 5.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.722em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.798em 1000em 3.047em -0.474em); top: -2.722em; left: 0em;"><span class="mrow" id="MathJax-Span-5002"><span class="msubsup" id="MathJax-Span-5003"><span style="display: inline-block; position: relative; width: 1.273em; height: 0px;"><span style="position: absolute; clip: rect(1.65em 1000em 2.667em -0.474em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-5004" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.128em; left: 0.865em;"><span class="mi" id="MathJax-Span-5005" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span></span><span class="mo" id="MathJax-Span-5006" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="msubsup" id="MathJax-Span-5007" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 2.186em; height: 0px;"><span style="position: absolute; clip: rect(1.65em 1000em 2.688em -0.467em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-5008" style="font-family: MathJax_Math; font-style: italic;">R</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.688em; left: 0.778em;"><span class="texatom" id="MathJax-Span-5009"><span class="mrow" id="MathJax-Span-5010"><span class="mi" id="MathJax-Span-5011" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-5012" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-5013" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span></span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.722em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.231em; vertical-align: -0.256em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-468">X_e \in R^{n \times e}</script></span>, 这里的<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-469-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-5014" style="width: 0.617em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.5em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.891em 1000em 2.678em -0.461em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-5015"><span class="mi" id="MathJax-Span-5016" style="font-family: MathJax_Math; font-style: italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.677em; vertical-align: -0.08em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-469">e</script></span> 是embedding space 维度。同时, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-470-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-5017" style="width: 5.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.444em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.798em 1000em 3.047em -0.467em); top: -2.722em; left: 0em;"><span class="mrow" id="MathJax-Span-5018"><span class="msubsup" id="MathJax-Span-5019"><span style="display: inline-block; position: relative; width: 1.077em; height: 0px;"><span style="position: absolute; clip: rect(1.65em 1000em 2.667em -0.467em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-5020" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.128em; left: 0.669em;"><span class="mi" id="MathJax-Span-5021" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span></span><span class="mo" id="MathJax-Span-5022" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="msubsup" id="MathJax-Span-5023" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 2.131em; height: 0px;"><span style="position: absolute; clip: rect(1.65em 1000em 2.688em -0.467em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-5024" style="font-family: MathJax_Math; font-style: italic;">R</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.688em; left: 0.778em;"><span class="texatom" id="MathJax-Span-5025"><span class="mrow" id="MathJax-Span-5026"><span class="mi" id="MathJax-Span-5027" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-5028" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-5029" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span></span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.722em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.231em; vertical-align: -0.256em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-470">P_e \in R^{p \times e}</script></span>, 这里的<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-471-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-5030" style="width: 0.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.556em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.891em 1000em 2.861em -0.539em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-5031"><span class="mi" id="MathJax-Span-5032" style="font-family: MathJax_Math; font-style: italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.897em; vertical-align: -0.299em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-471">p</script></span> 是prompt的长度。将两者拼接起来，得到<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-472-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-5033" style="width: 9.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.222em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.615em 1000em 3.139em -0.382em); top: -2.722em; left: 0em;"><span class="mrow" id="MathJax-Span-5034"><span class="mo" id="MathJax-Span-5035" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-5036"><span style="display: inline-block; position: relative; width: 1.077em; height: 0px;"><span style="position: absolute; clip: rect(1.65em 1000em 2.667em -0.467em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-5037" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.128em; left: 0.669em;"><span class="mi" id="MathJax-Span-5038" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span></span><span class="mo" id="MathJax-Span-5039" style="font-family: MathJax_Main;">;</span><span class="msubsup" id="MathJax-Span-5040" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.273em; height: 0px;"><span style="position: absolute; clip: rect(1.65em 1000em 2.667em -0.474em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-5041" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.128em; left: 0.865em;"><span class="mi" id="MathJax-Span-5042" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span></span><span class="mo" id="MathJax-Span-5043" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-5044" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="msubsup" id="MathJax-Span-5045" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 3.631em; height: 0px;"><span style="position: absolute; clip: rect(1.65em 1000em 2.688em -0.467em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-5046" style="font-family: MathJax_Math; font-style: italic;">R</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.688em; left: 0.778em;"><span class="texatom" id="MathJax-Span-5047"><span class="mrow" id="MathJax-Span-5048"><span class="mo" id="MathJax-Span-5049" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-5050" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-5051" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-5052" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-5053" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-5054" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-5055" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span></span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.722em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.562em; vertical-align: -0.367em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-472">[P_e;X_e] \in R^{(p+n)\times e}</script></span>。训练时，只更新<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-473-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-5056" style="width: 1.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.295em 1000em 2.621em -0.465em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-5057"><span class="msubsup" id="MathJax-Span-5058"><span style="display: inline-block; position: relative; width: 0.964em; height: 0px;"><span style="position: absolute; clip: rect(1.628em 1000em 2.677em -0.465em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-5059" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.128em; left: 0.5em;"><span class="mi" id="MathJax-Span-5060" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.324em; vertical-align: -0.411em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-473">\theta_p</script></span>.</p><p>Design Decision:</p><ul>
<li>random</li><li>embedding from model’s vocabulary</li><li>embeddings that enumerate the output classes</li></ul><p>代码：</p><pre><code data-origin="<pre><code>from peft import PromptTuningConfig, get_peft_model, TaskType, PromptTuningInit

# Soft Prompt
# config = PromptTuningConfig(task_type=TaskType.CAUSAL_LM, num_virtual_tokens=10)
# config
# Hard Prompt
config = PromptTuningConfig(
    task_type=TaskType.CAUSAL_LM, 
    prompt_tuning_init=PromptTuningInit.TEXT, 
    prompt_tuning_init_text=&quot;下面是一段人与机器人的对话。&quot;,                       num_virtual_tokens=len(tokenizer(&quot;下面是一段人与机器人的对话。&quot;)[&quot;input_ids&quot;]),  
    tokenizer_name_or_path=&quot;Langboat/bloom-1b4-zh&quot;)

model = get_peft_model(model, config)

# inference
from peft import PeftModel
peft_model = PeftModel.from_pretrained(model=model, model_id=&quot;./chatbot/checkpoint-500/&quot;)
peft_model = peft_model.cuda()
ipt = tokenizer(&quot;Human: {}\n{}&quot;.format(&quot;考试有哪些技巧？&quot;, &quot;&quot;).strip() + &quot;\n\nAssistant: &quot;, return_tensors=&quot;pt&quot;).to(peft_model.device)
print(tokenizer.decode(peft_model.generate(**ipt, max_length=128, do_sample=True)[0], skip_special_tokens=True))
</code></pre>">from peft import PromptTuningConfig, get_peft_model, TaskType, PromptTuningInit

# Soft Prompt
# config = PromptTuningConfig(task_type=TaskType.CAUSAL_LM, num_virtual_tokens=10)
# config
# Hard Prompt
config = PromptTuningConfig(
    task_type=TaskType.CAUSAL_LM, 
    prompt_tuning_init=PromptTuningInit.TEXT, 
    prompt_tuning_init_text="下面是一段人与机器人的对话。",                       num_virtual_tokens=len(tokenizer("下面是一段人与机器人的对话。")["input_ids"]),  
    tokenizer_name_or_path="Langboat/bloom-1b4-zh")

model = get_peft_model(model, config)

# inference
from peft import PeftModel
peft_model = PeftModel.from_pretrained(model=model, model_id="./chatbot/checkpoint-500/")
peft_model = peft_model.cuda()
ipt = tokenizer("Human: {}\n{}".format("考试有哪些技巧？", "").strip() + "\n\nAssistant: ", return_tensors="pt").to(peft_model.device)
print(tokenizer.decode(peft_model.generate(**ipt, max_length=128, do_sample=True)[0], skip_special_tokens=True))
</code></pre><h4 id="2.3.3-p-tuning"><a name="2.3.3-p-tuning" href="#2.3.3-p-tuning"></a>2.3.3 P-Tuning</h4><p>论文：</p><pre><code data-origin="<pre><code>GPT Understands, Too
https://arxiv.org/pdf/2103.10385.pdf
P-Tuning v2: Prompt Tuning Can Be Comparable to Fine-tuning Universally Across Scales and Tasks
https://arxiv.org/pdf/2110.07602.pdf
</code></pre>">GPT Understands, Too
https://arxiv.org/pdf/2103.10385.pdf
P-Tuning v2: Prompt Tuning Can Be Comparable to Fine-tuning Universally Across Scales and Tasks
https://arxiv.org/pdf/2110.07602.pdf
</code></pre><p>原理：</p><h4 id="2.3.4-prefix-tuning"><a name="2.3.4-prefix-tuning" href="#2.3.4-prefix-tuning"></a>2.3.4 Prefix-Tuning</h4><p>论文：</p><pre><code data-origin="<pre><code>Prefix-Tuning: Optimizing Continuous Prompts for Generation
https://arxiv.org/pdf/2101.00190.pdf
</code></pre>">Prefix-Tuning: Optimizing Continuous Prompts for Generation
https://arxiv.org/pdf/2101.00190.pdf
</code></pre><p>原理：</p><p><img src="pic/3/prefix.jpg" alt="prefix" title="prefix"></p><ul>
<li>autoregressive LM: <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-483-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-5190" style="width: 5.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.722em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.806em 1000em 3.139em -0.382em); top: -2.722em; left: 0em;"><span class="mrow" id="MathJax-Span-5191"><span class="mo" id="MathJax-Span-5192" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-5193" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mi" id="MathJax-Span-5194" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-5195" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-5196" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-5197" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-5198" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-5199" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-5200" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">x</span><span class="mo" id="MathJax-Span-5201" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.722em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.333em; vertical-align: -0.367em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-483">[Prefix; x]</script></span></li><li>encode-decode: <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-484-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-5202" style="width: 11.483em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.556em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.806em 1000em 3.139em -0.382em); top: -2.722em; left: 0em;"><span class="mrow" id="MathJax-Span-5203"><span class="mo" id="MathJax-Span-5204" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-5205" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mi" id="MathJax-Span-5206" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-5207" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-5208" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-5209" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-5210" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-5211" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-5212" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">x</span><span class="mo" id="MathJax-Span-5213" style="font-family: MathJax_Main;">;</span><span class="msubsup" id="MathJax-Span-5214" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 3.464em; height: 0px;"><span style="position: absolute; clip: rect(1.628em 1000em 2.872em -0.467em); top: -2.5em; left: 0em;"><span class="texatom" id="MathJax-Span-5215"><span class="mrow" id="MathJax-Span-5216"><span class="mi" id="MathJax-Span-5217" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mi" id="MathJax-Span-5218" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-5219" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-5220" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-5221" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-5222" style="font-family: MathJax_Math; font-style: italic;">x</span></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.71em; left: 3.167em;"><span class="mo" id="MathJax-Span-5223" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span></span><span class="mo" id="MathJax-Span-5224" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-5225" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-5226" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.722em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.333em; vertical-align: -0.367em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-484">[Prefix; x; {Prefix}^,; y]</script></span></li></ul><p>代码：</p><pre><code data-origin="<pre><code>from peft import PrefixTuningConfig, get_peft_model, TaskType
config = PrefixTuningConfig(task_type=TaskType.CAUSAL_LM, num_virtual_tokens=10, prefix_projection=True)

model = get_peft_model(model, config)

# 核心代码
if peft_config.peft_type == PeftType.PREFIX_TUNING:
    past_key_values = self.get_prompt(batch_size)
    return self.base_model(
        input_ids=input_ids, inputs_embeds=inputs_embeds, past_key_values=past_key_values, **kwargs
    )

class PrefixEncoder(torch.nn.Module):
    r&quot;&quot;&quot;
    The `torch.nn` model to encode the prefix.

    Args:
        config ([`PrefixTuningConfig`]): The configuration of the prefix encoder.

    Example:

    ```py
    &amp;gt;&amp;gt;&amp;gt; from peft import PrefixEncoder, PrefixTuningConfig

    &amp;gt;&amp;gt;&amp;gt; config = PrefixTuningConfig(
    ...     peft_type=&quot;PREFIX_TUNING&quot;,
    ...     task_type=&quot;SEQ_2_SEQ_LM&quot;,
    ...     num_virtual_tokens=20,
    ...     token_dim=768,
    ...     num_transformer_submodules=1,
    ...     num_attention_heads=12,
    ...     num_layers=12,
    ...     encoder_hidden_size=768,
    ... )
    &amp;gt;&amp;gt;&amp;gt; prefix_encoder = PrefixEncoder(config)
</code></pre>">from peft import PrefixTuningConfig, get_peft_model, TaskType
config = PrefixTuningConfig(task_type=TaskType.CAUSAL_LM, num_virtual_tokens=10, prefix_projection=True)

model = get_peft_model(model, config)

# 核心代码
if peft_config.peft_type == PeftType.PREFIX_TUNING:
    past_key_values = self.get_prompt(batch_size)
    return self.base_model(
        input_ids=input_ids, inputs_embeds=inputs_embeds, past_key_values=past_key_values, **kwargs
    )

class PrefixEncoder(torch.nn.Module):
    r"""
    The `torch.nn` model to encode the prefix.

    Args:
        config ([`PrefixTuningConfig`]): The configuration of the prefix encoder.

    Example:

    ```py
    &gt;&gt;&gt; from peft import PrefixEncoder, PrefixTuningConfig

    &gt;&gt;&gt; config = PrefixTuningConfig(
    ...     peft_type="PREFIX_TUNING",
    ...     task_type="SEQ_2_SEQ_LM",
    ...     num_virtual_tokens=20,
    ...     token_dim=768,
    ...     num_transformer_submodules=1,
    ...     num_attention_heads=12,
    ...     num_layers=12,
    ...     encoder_hidden_size=768,
    ... )
    &gt;&gt;&gt; prefix_encoder = PrefixEncoder(config)
</code></pre><pre><code data-origin="<pre><code>**Attributes**:
    - **embedding** (`torch.nn.Embedding`) -- The embedding layer of the prefix encoder.
    - **transform** (`torch.nn.Sequential`) -- The two-layer MLP to transform the prefix embeddings if
      `prefix_projection` is `True`.
    - **prefix_projection** (`bool`) -- Whether to project the prefix embeddings.

Input shape: (`batch_size`, `num_virtual_tokens`)

Output shape: (`batch_size`, `num_virtual_tokens`, `2*layers*hidden`)
&quot;&quot;&quot;

def __init__(self, config):
    super().__init__()
    self.prefix_projection = config.prefix_projection
    token_dim = config.token_dim
    num_layers = config.num_layers
    encoder_hidden_size = config.encoder_hidden_size
    num_virtual_tokens = config.num_virtual_tokens
    if self.prefix_projection and not config.inference_mode:
        # Use a two-layer MLP to encode the prefix
        self.embedding = torch.nn.Embedding(num_virtual_tokens, token_dim)
        self.transform = torch.nn.Sequential(
            torch.nn.Linear(token_dim, encoder_hidden_size),
            torch.nn.Tanh(),
            torch.nn.Linear(encoder_hidden_size, num_layers * 2 * token_dim),
        )
    else:
        self.embedding = torch.nn.Embedding(num_virtual_tokens, num_layers * 2 * token_dim)

def forward(self, prefix: torch.Tensor):
    if self.prefix_projection:
        prefix_tokens = self.embedding(prefix)
        past_key_values = self.transform(prefix_tokens)
    else:
        past_key_values = self.embedding(prefix)
    return past_key_values
</code></pre>">**Attributes**:
    - **embedding** (`torch.nn.Embedding`) -- The embedding layer of the prefix encoder.
    - **transform** (`torch.nn.Sequential`) -- The two-layer MLP to transform the prefix embeddings if
      `prefix_projection` is `True`.
    - **prefix_projection** (`bool`) -- Whether to project the prefix embeddings.

Input shape: (`batch_size`, `num_virtual_tokens`)

Output shape: (`batch_size`, `num_virtual_tokens`, `2*layers*hidden`)
"""

def __init__(self, config):
    super().__init__()
    self.prefix_projection = config.prefix_projection
    token_dim = config.token_dim
    num_layers = config.num_layers
    encoder_hidden_size = config.encoder_hidden_size
    num_virtual_tokens = config.num_virtual_tokens
    if self.prefix_projection and not config.inference_mode:
        # Use a two-layer MLP to encode the prefix
        self.embedding = torch.nn.Embedding(num_virtual_tokens, token_dim)
        self.transform = torch.nn.Sequential(
            torch.nn.Linear(token_dim, encoder_hidden_size),
            torch.nn.Tanh(),
            torch.nn.Linear(encoder_hidden_size, num_layers * 2 * token_dim),
        )
    else:
        self.embedding = torch.nn.Embedding(num_virtual_tokens, num_layers * 2 * token_dim)

def forward(self, prefix: torch.Tensor):
    if self.prefix_projection:
        prefix_tokens = self.embedding(prefix)
        past_key_values = self.transform(prefix_tokens)
    else:
        past_key_values = self.embedding(prefix)
    return past_key_values
</code></pre><pre><code data-origin="<pre><code>if peft_config.peft_type == PeftType.PREFIX_TUNING:
    prompt_tokens = prompt_tokens[:, : peft_config.num_virtual_tokens]
    if peft_config.inference_mode:
        past_key_values = prompt_encoder.embedding.weight.repeat(batch_size, 1, 1)
    else:
        past_key_values = prompt_encoder(prompt_tokens)
    if self.base_model_torch_dtype is not None:
        past_key_values = past_key_values.to(self.base_model_torch_dtype)
    past_key_values = past_key_values.view(
        batch_size,
        peft_config.num_virtual_tokens,
        peft_config.num_layers * 2,
        peft_config.num_attention_heads,
        peft_config.token_dim // peft_config.num_attention_heads,
    )
    if peft_config.num_transformer_submodules == 2:
        past_key_values = torch.cat([past_key_values, past_key_values], dim=2)
    past_key_values = past_key_values.permute([2, 0, 3, 1, 4]).split(
        peft_config.num_transformer_submodules * 2
    )
    if TRANSFORMERS_MODELS_TO_PREFIX_TUNING_POSTPROCESS_MAPPING.get(self.config.model_type, None) is not None:
        post_process_fn = TRANSFORMERS_MODELS_TO_PREFIX_TUNING_POSTPROCESS_MAPPING[self.config.model_type]
        past_key_values = post_process_fn(past_key_values)
    return past_key_values
</code></pre>">if peft_config.peft_type == PeftType.PREFIX_TUNING:
    prompt_tokens = prompt_tokens[:, : peft_config.num_virtual_tokens]
    if peft_config.inference_mode:
        past_key_values = prompt_encoder.embedding.weight.repeat(batch_size, 1, 1)
    else:
        past_key_values = prompt_encoder(prompt_tokens)
    if self.base_model_torch_dtype is not None:
        past_key_values = past_key_values.to(self.base_model_torch_dtype)
    past_key_values = past_key_values.view(
        batch_size,
        peft_config.num_virtual_tokens,
        peft_config.num_layers * 2,
        peft_config.num_attention_heads,
        peft_config.token_dim // peft_config.num_attention_heads,
    )
    if peft_config.num_transformer_submodules == 2:
        past_key_values = torch.cat([past_key_values, past_key_values], dim=2)
    past_key_values = past_key_values.permute([2, 0, 3, 1, 4]).split(
        peft_config.num_transformer_submodules * 2
    )
    if TRANSFORMERS_MODELS_TO_PREFIX_TUNING_POSTPROCESS_MAPPING.get(self.config.model_type, None) is not None:
        post_process_fn = TRANSFORMERS_MODELS_TO_PREFIX_TUNING_POSTPROCESS_MAPPING[self.config.model_type]
        past_key_values = post_process_fn(past_key_values)
    return past_key_values
</code></pre><h4 id="2.3.5-lora"><a name="2.3.5-lora" href="#2.3.5-lora"></a>2.3.5 Lora</h4><p>  论文：</p><pre><code data-origin="<pre><code>LORA: LOW-RANK ADAPTATION OF LARGE LANGUAGE MODELS
https://arxiv.org/pdf/2106.09685.pdf
AdaLoRA: ADAPTIVE BUDGET ALLOCATION FOR PARAMETEREFFICIENT FINE-TUNING
https://arxiv.org/pdf/2303.10512.pdf
https://github.com/QingruZhang/AdaLoRA
QLORA: Efficient Finetuning of Quantized LLMs
https://arxiv.org/pdf/2305.14314.pdf
</code></pre>">LORA: LOW-RANK ADAPTATION OF LARGE LANGUAGE MODELS
https://arxiv.org/pdf/2106.09685.pdf
AdaLoRA: ADAPTIVE BUDGET ALLOCATION FOR PARAMETEREFFICIENT FINE-TUNING
https://arxiv.org/pdf/2303.10512.pdf
https://github.com/QingruZhang/AdaLoRA
QLORA: Efficient Finetuning of Quantized LLMs
https://arxiv.org/pdf/2305.14314.pdf
</code></pre><p>原理：</p><ul>
<li><p>lora：<br><span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-568-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-6120" style="width: 25.883em; display: inline-block;"><span style="display: inline-block; position: relative; width: 21.556em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.806em 1000em 3.139em -0.452em); top: -2.722em; left: 0em;"><span class="mrow" id="MathJax-Span-6121"><span class="mi" id="MathJax-Span-6122" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mo" id="MathJax-Span-6123" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-6124" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.415em; height: 0px;"><span style="position: absolute; clip: rect(1.65em 1000em 2.689em -0.449em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-6125" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.128em; left: 0.952em;"><span class="mn" id="MathJax-Span-6126" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span></span><span class="mi" id="MathJax-Span-6127" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-6128" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-6129" style="font-family: MathJax_Main; padding-left: 0.222em;">Δ</span><span class="mi" id="MathJax-Span-6130" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span class="mo" id="MathJax-Span-6131" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="mi" id="MathJax-Span-6132" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">x</span><span class="mo" id="MathJax-Span-6133" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-6134" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.415em; height: 0px;"><span style="position: absolute; clip: rect(1.65em 1000em 2.689em -0.449em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-6135" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.128em; left: 0.952em;"><span class="mn" id="MathJax-Span-6136" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span></span><span class="mi" id="MathJax-Span-6137" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-6138" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-6139" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">B</span><span class="mi" id="MathJax-Span-6140" style="font-family: MathJax_Math; font-style: italic;">A</span><span class="mi" id="MathJax-Span-6141" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-6142" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-6143" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="msubsup" id="MathJax-Span-6144"><span style="display: inline-block; position: relative; width: 1.415em; height: 0px;"><span style="position: absolute; clip: rect(1.65em 1000em 2.689em -0.449em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-6145" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.128em; left: 0.952em;"><span class="mi" id="MathJax-Span-6146" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">o</span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span></span><span class="mo" id="MathJax-Span-6147" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-6148" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">B</span><span class="mi" id="MathJax-Span-6149" style="font-family: MathJax_Math; font-style: italic;">A</span><span class="mo" id="MathJax-Span-6150" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-6151" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.722em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.333em; vertical-align: -0.367em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-568">h=W_0 x + \Delta W * x  = W_0 x + BAx = (W_o + BA) x</script></span>， 其中 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-569-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-6152" style="width: 5.817em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.833em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.655em 1000em 3.054em -0.449em); top: -2.722em; left: 0em;"><span class="mrow" id="MathJax-Span-6153"><span class="msubsup" id="MathJax-Span-6154"><span style="display: inline-block; position: relative; width: 1.415em; height: 0px;"><span style="position: absolute; clip: rect(1.65em 1000em 2.689em -0.449em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-6155" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.128em; left: 0.952em;"><span class="mn" id="MathJax-Span-6156" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span></span><span class="mo" id="MathJax-Span-6157" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="msubsup" id="MathJax-Span-6158" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 2.186em; height: 0px;"><span style="position: absolute; clip: rect(1.65em 1000em 2.688em -0.467em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-6159" style="font-family: MathJax_Math; font-style: italic;">R</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.688em; left: 0.778em;"><span class="texatom" id="MathJax-Span-6160"><span class="mrow" id="MathJax-Span-6161"><span class="mi" id="MathJax-Span-6162" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-6163" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-6164" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.722em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.413em; vertical-align: -0.265em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-569">W_0 \in R^{d \times k}</script></span>, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-570-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-6165" style="width: 5.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.167em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.655em 1000em 2.929em -0.465em); top: -2.722em; left: 0em;"><span class="mrow" id="MathJax-Span-6166"><span class="mi" id="MathJax-Span-6167" style="font-family: MathJax_Math; font-style: italic;">B</span><span class="mo" id="MathJax-Span-6168" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="msubsup" id="MathJax-Span-6169" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 2.131em; height: 0px;"><span style="position: absolute; clip: rect(1.65em 1000em 2.688em -0.467em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-6170" style="font-family: MathJax_Math; font-style: italic;">R</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.688em; left: 0.778em;"><span class="texatom" id="MathJax-Span-6171"><span class="mrow" id="MathJax-Span-6172"><span class="mi" id="MathJax-Span-6173" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-6174" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-6175" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">r</span></span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.722em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.262em; vertical-align: -0.115em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-570">B \in R^{d \times r}</script></span>, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-571-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-6176" style="width: 4.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.111em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.655em 1000em 2.929em -0.465em); top: -2.722em; left: 0em;"><span class="mrow" id="MathJax-Span-6177"><span class="mi" id="MathJax-Span-6178" style="font-family: MathJax_Math; font-style: italic;">A</span><span class="mo" id="MathJax-Span-6179" style="font-family: MathJax_Main; padding-left: 0.278em;">∈</span><span class="msubsup" id="MathJax-Span-6180" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 2.131em; height: 0px;"><span style="position: absolute; clip: rect(1.65em 1000em 2.688em -0.467em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-6181" style="font-family: MathJax_Math; font-style: italic;">R</span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.688em; left: 0.778em;"><span class="texatom" id="MathJax-Span-6182"><span class="mrow" id="MathJax-Span-6183"><span class="mi" id="MathJax-Span-6184" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">r</span><span class="mo" id="MathJax-Span-6185" style="font-size: 70.7%; font-family: MathJax_Main;">×</span><span class="mi" id="MathJax-Span-6186" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.722em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.262em; vertical-align: -0.115em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-571">A \in R^{r \times k}</script></span>, <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-572-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-6187" style="width: 8.017em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.667em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.806em 1000em 3.139em -0.479em); top: -2.722em; left: 0em;"><span class="mrow" id="MathJax-Span-6188"><span class="mi" id="MathJax-Span-6189" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mo" id="MathJax-Span-6190" style="font-family: MathJax_Main; padding-left: 0.278em;">&lt;<span style="font-family: MathJax_Main; font-style: normal; font-weight: normal;">&lt;</span></span><span class="mi" id="MathJax-Span-6191" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">m</span><span class="mi" id="MathJax-Span-6192" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-6193" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-6194" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-6195" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-6196" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-6197" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">k</span><span class="mo" id="MathJax-Span-6198" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.722em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.333em; vertical-align: -0.367em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-572"> r<< min(d, k)</script></span>。</p>
<p> 初始时，<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-573-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-6199" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.778em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.617em 1000em 2.667em -0.465em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-6200"><span class="mi" id="MathJax-Span-6201" style="font-family: MathJax_Math; font-style: italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.993em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-573">A</script></span>: random Gaussion initialization， <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-574-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-6202" style="width: 0.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.778em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.65em 1000em 2.667em -0.465em); top: -2.5em; left: 0em;"><span class="mrow" id="MathJax-Span-6203"><span class="mi" id="MathJax-Span-6204" style="font-family: MathJax_Math; font-style: italic;">B</span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 0.953em; vertical-align: -0.067em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-574">B</script></span>: zero， 同时为<span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-575-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-6205" style="width: 2.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.889em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.84em 1000em 2.911em -0.454em); top: -2.722em; left: 0em;"><span class="mrow" id="MathJax-Span-6206"><span class="mi" id="MathJax-Span-6207" style="font-family: MathJax_Main;">Δ</span><span class="mi" id="MathJax-Span-6208" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.722em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.019em; vertical-align: -0.093em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-575">\Delta W</script></span> 添加缩放系数 <span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-576-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-6209" style="width: 1.083em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.889em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.266em 1000em 2.686em -0.5em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-6210"><span class="mfrac" id="MathJax-Span-6211"><span style="display: inline-block; position: relative; width: 0.62em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.799em 1000em 2.452em -0.476em); top: -2.7em; left: 50%; margin-left: -0.25em;"><span class="mi" id="MathJax-Span-6212" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">α</span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span><span style="position: absolute; clip: rect(1.799em 1000em 2.452em -0.485em); top: -1.933em; left: 50%; margin-left: -0.167em;"><span class="mi" id="MathJax-Span-6213" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">r</span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span><span style="position: absolute; clip: rect(0.819em 1000em 1.222em -0.5em); top: -1.276em; left: 0em;"><span style="border-left-width: 0.62em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0em;"></span><span style="display: inline-block; width: 0px; height: 1.056em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.438em; vertical-align: -0.49em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-576">\frac{\alpha} {r}</script></span>。</p>
</li></ul><p><img src="pic/3/lora.jpg" alt="lora" title="lora"></p><ul>
<li><p>adalora：</p>
<ul>
<li><p><span><span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-504-Frame" role="textbox" aria-readonly="true"><nobr><span class="math" id="MathJax-Span-5460" style="width: 18.683em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.556em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.84em 1000em 3.083em -0.452em); top: -2.722em; left: 0em;"><span class="mrow" id="MathJax-Span-5461"><span class="mi" id="MathJax-Span-5462" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mo" id="MathJax-Span-5463" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-5464" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.415em; height: 0px;"><span style="position: absolute; clip: rect(1.65em 1000em 2.689em -0.449em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-5465" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.128em; left: 0.952em;"><span class="mn" id="MathJax-Span-5466" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span></span><span class="mi" id="MathJax-Span-5467" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-5468" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-5469" style="font-family: MathJax_Main; padding-left: 0.222em;">Δ</span><span class="mi" id="MathJax-Span-5470" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span class="mo" id="MathJax-Span-5471" style="font-family: MathJax_Main; padding-left: 0.222em;">∗</span><span class="mi" id="MathJax-Span-5472" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">x</span><span class="mo" id="MathJax-Span-5473" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-5474" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.415em; height: 0px;"><span style="position: absolute; clip: rect(1.65em 1000em 2.689em -0.449em); top: -2.5em; left: 0em;"><span class="mi" id="MathJax-Span-5475" style="font-family: MathJax_Math; font-style: italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.104em;"></span></span><span style="display: inline-block; width: 0px; height: 2.5em;"></span></span><span style="position: absolute; top: -2.128em; left: 0.952em;"><span class="mn" id="MathJax-Span-5476" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.278em;"></span></span></span></span><span class="mi" id="MathJax-Span-5477" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-5478" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-5479" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mi" id="MathJax-Span-5480" style="font-family: MathJax_Main;">Λ</span><span class="mi" id="MathJax-Span-5481" style="font-family: MathJax_Math; font-style: italic;">Q</span><span class="mi" id="MathJax-Span-5482" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.722em;"></span></span></span><span style="border-left-width: 0em; border-left-style: solid; display: inline-block; overflow: hidden; width: 0px; height: 1.225em; vertical-align: -0.299em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-504">h=W_0 x + \Delta W * x  = W_0 x + P\Lambda Q x</script></span></p>
</li><li><p>训练过程：<br><img src="pic/3/adalora-0.jpg" alt="adalora-0" title="adalora-0"></p>
</li><li><p>损失函数及参数更新：<br><img src="pic/3/adalora-1.jpg" alt="adalora-1" title="adalora-1"><br><img src="pic/3/adalora-2.jpg" alt="adalora-2" title="adalora-2"></p>
</li><li><p>三元组参数重要重要性计算：<br><img src="pic/3/adalora-3.jpg" alt="adalora-3" title="adalora-3"></p>
</li></ul>
</li><li><p>qlora：<br>  <img src="pic/3/qlora.jpg" alt="qlora" title="qlora"><br>代码：</p>
</li></ul><pre><code data-origin="<pre><code>from peft import LoraConfig, TaskType, get_peft_model
config = LoraConfig(task_type=TaskType.CAUSAL_LM, target_modules=[&quot;.*\.1.*query_key_value&quot;], modules_to_save=[&quot;word_embeddings&quot;])
</code></pre>">from peft import LoraConfig, TaskType, get_peft_model
config = LoraConfig(task_type=TaskType.CAUSAL_LM, target_modules=[".*\.1.*query_key_value"], modules_to_save=["word_embeddings"])
</code></pre><h4 id="2.3.6-ia3"><a name="2.3.6-ia3" href="#2.3.6-ia3"></a>2.3.6 IA3</h4><pre><code data-origin="<pre><code>Few-Shot Parameter-Efficient Fine-Tuning is Better and Cheaper than In-Context Learning
https://arxiv.org/pdf/2205.05638.pdf
</code></pre>">Few-Shot Parameter-Efficient Fine-Tuning is Better and Cheaper than In-Context Learning
https://arxiv.org/pdf/2205.05638.pdf
</code></pre><h4 id="2.3.7-adapter"><a name="2.3.7-adapter" href="#2.3.7-adapter"></a>2.3.7 Adapter</h4><p>论文:</p><pre><code data-origin="<pre><code>Parameter-Efficient Transfer Learning for NLP
https://arxiv.org/pdf/1902.00751.pdf
AdapterFusion:Non-Destructive Task Composition for Transfer Learning
https://arxiv.org/pdf/2005.00247.pdf
MAD-X: An Adapter-Based Framework for Multi-Task Cross-Lingual Transfer
</code></pre>">Parameter-Efficient Transfer Learning for NLP
https://arxiv.org/pdf/1902.00751.pdf
AdapterFusion:Non-Destructive Task Composition for Transfer Learning
https://arxiv.org/pdf/2005.00247.pdf
MAD-X: An Adapter-Based Framework for Multi-Task Cross-Lingual Transfer
</code></pre><p>原理：</p><ul>
<li>adapter：<br><img src="pic/3/adapter.jpg" alt="adapter" title="adapter"></li></ul><pre><code data-origin="<pre><code>  def feedforward_adapter(input_tensor, hidden_size=64, init_scale=1e-3):
    &quot;&quot;&quot;A feedforward adapter layer with a bottleneck.

    Implements a bottleneck layer with a user-specified nonlinearity and an
    identity residual connection. All variables created are added to the
    &quot;adapters&quot; collection.

    Args:
        input_tensor: input Tensor of shape [batch size, hidden dimension]
        hidden_size: dimension of the bottleneck layer.
        init_scale: Scale of the initialization distribution used for weights.

    Returns:
        Tensor of the same shape as x.
    &quot;&quot;&quot;
    with tf.variable_scope(&quot;adapters&quot;):
        in_size = input_tensor.get_shape().as_list()[1]
        w1 = tf.get_variable(
            &quot;weights1&quot;, [in_size, hidden_size],
            initializer=tf.truncated_normal_initializer(stddev=init_scale),
            collections=[&quot;adapters&quot;, tf.GraphKeys.GLOBAL_VARIABLES])
        b1 = tf.get_variable(
            &quot;biases1&quot;, [1, hidden_size],
            initializer=tf.zeros_initializer(),
            collections=[&quot;adapters&quot;, tf.GraphKeys.GLOBAL_VARIABLES])
        net = tf.tensordot(input_tensor, w1, [[1], [0]]) + b1

        net = gelu(net)

        w2 = tf.get_variable(
            &quot;weights2&quot;, [hidden_size, in_size],
            initializer=tf.truncated_normal_initializer(stddev=init_scale),
            collections=[&quot;adapters&quot;, tf.GraphKeys.GLOBAL_VARIABLES])
        b2 = tf.get_variable(
            &quot;biases2&quot;, [1, in_size],
            initializer=tf.zeros_initializer(),
            collections=[&quot;adapters&quot;, tf.GraphKeys.GLOBAL_VARIABLES])
        net = tf.tensordot(net, w2, [[1], [0]]) + b2
    return net + input_tensor
</code></pre>">  def feedforward_adapter(input_tensor, hidden_size=64, init_scale=1e-3):
    """A feedforward adapter layer with a bottleneck.

    Implements a bottleneck layer with a user-specified nonlinearity and an
    identity residual connection. All variables created are added to the
    "adapters" collection.

    Args:
        input_tensor: input Tensor of shape [batch size, hidden dimension]
        hidden_size: dimension of the bottleneck layer.
        init_scale: Scale of the initialization distribution used for weights.

    Returns:
        Tensor of the same shape as x.
    """
    with tf.variable_scope("adapters"):
        in_size = input_tensor.get_shape().as_list()[1]
        w1 = tf.get_variable(
            "weights1", [in_size, hidden_size],
            initializer=tf.truncated_normal_initializer(stddev=init_scale),
            collections=["adapters", tf.GraphKeys.GLOBAL_VARIABLES])
        b1 = tf.get_variable(
            "biases1", [1, hidden_size],
            initializer=tf.zeros_initializer(),
            collections=["adapters", tf.GraphKeys.GLOBAL_VARIABLES])
        net = tf.tensordot(input_tensor, w1, [[1], [0]]) + b1

        net = gelu(net)

        w2 = tf.get_variable(
            "weights2", [hidden_size, in_size],
            initializer=tf.truncated_normal_initializer(stddev=init_scale),
            collections=["adapters", tf.GraphKeys.GLOBAL_VARIABLES])
        b2 = tf.get_variable(
            "biases2", [1, in_size],
            initializer=tf.zeros_initializer(),
            collections=["adapters", tf.GraphKeys.GLOBAL_VARIABLES])
        net = tf.tensordot(net, w2, [[1], [0]]) + b2
    return net + input_tensor
</code></pre><ul>
<li><p>adapterFusion</p>
<ul>
<li>knowledge extraction stage</li><li><p>knowledge composition step<br><img src="pic/3/adapterfusion.jpg" alt="adapterfusion" title="adapterfusion"><br><img src="pic/3/adapterfusion-2.jpg" alt="adapterfusion-2" title="adapterfusion-2"><br><img src="pic/3/adapterfusion-sta.jpg" alt="adapterfusion-sta" title="adapterfusion-sta"><br><img src="pic/3/adapterfusion-mta.jpg" alt="adapterfusion-mta" title="adapterfusion-mta"><br><img src="pic/3/adapterfusion-stage2.jpg" alt="adapterfusion-stage2" title="adapterfusion-stage2"><br><img src="pic/3/adapterfusion-stage2-2.jpg" alt="adapterfusion-stage2-2" title="adapterfusion-satge2-2"></p>
<pre><code data-origin="<pre><code>model = BertModelWithHeads.from_pretrained(&quot;bert-base-uncased&quot;)
model.load_adapter(&quot;nli/multinli@ukp&quot;, load_as=&quot;multinli&quot;, with_head=False)
model.load_adapter(&quot;sts/qqp@ukp&quot;, with_head=False)
model.load_adapter(&quot;nli/qnli@ukp&quot;, with_head=False)
model.add_classification_head(&quot;cb&quot;)

adapter_setup = Fuse(&quot;multinli&quot;, &quot;qqp&quot;, &quot;qnli&quot;)
model.add_fusion(adapter_setup)
model.set_active_adapters(adapter_setup)
model.train_fusion(adapter_setup)
</code></pre>">model = BertModelWithHeads.from_pretrained("bert-base-uncased")
model.load_adapter("nli/multinli@ukp", load_as="multinli", with_head=False)
model.load_adapter("sts/qqp@ukp", with_head=False)
model.load_adapter("nli/qnli@ukp", with_head=False)
model.add_classification_head("cb")

adapter_setup = Fuse("multinli", "qqp", "qnli")
model.add_fusion(adapter_setup)
model.set_active_adapters(adapter_setup)
model.train_fusion(adapter_setup)
</code></pre></li></ul>
</li><li><p>MAD-X</p>
</li></ul><h3 id="2.4-强化学习"><a name="2.4-强化学习" href="#2.4-强化学习"></a>2.4 强化学习</h3><h4 id="2.4.1-奖励模型"><a name="2.4.1-奖励模型" href="#2.4.1-奖励模型"></a>2.4.1 奖励模型</h4><pre><code data-origin="<pre><code>https://zhuanlan.zhihu.com/p/595579042
</code></pre>">https://zhuanlan.zhihu.com/p/595579042
</code></pre><h4 id="2.4.2-rlhf"><a name="2.4.2-rlhf" href="#2.4.2-rlhf"></a>2.4.2 RLHF</h4><h2 id="3-多模态"><a name="3-多模态" href="#3-多模态"></a>3 多模态</h2><h3 id="3.1-数据"><a name="3.1-数据" href="#3.1-数据"></a>3.1 数据</h3><h3 id="3.2-多模态模型"><a name="3.2-多模态模型" href="#3.2-多模态模型"></a>3.2 多模态模型</h3><h4 id="3.2.1-clip"><a name="3.2.1-clip" href="#3.2.1-clip"></a>3.2.1 CLIP</h4><pre><code data-origin="<pre><code>Learning Transferable Visual Models From Natural Language Supervision
https://arxiv.org/pdf/2103.00020.pdf
</code></pre>">Learning Transferable Visual Models From Natural Language Supervision
https://arxiv.org/pdf/2103.00020.pdf
</code></pre><h4 id="3.2.2-stable-diffusion"><a name="3.2.2-stable-diffusion" href="#3.2.2-stable-diffusion"></a>3.2.2 Stable Diffusion</h4><pre><code data-origin="<pre><code>High-Resolution Image Synthesis with Latent Diffusion Models
https://arxiv.org/pdf/2112.10752.pdf
</code></pre>">High-Resolution Image Synthesis with Latent Diffusion Models
https://arxiv.org/pdf/2112.10752.pdf
</code></pre><h4 id="3.2.3-controlnet"><a name="3.2.3-controlnet" href="#3.2.3-controlnet"></a>3.2.3 ControlNet</h4><pre><code data-origin="<pre><code>Adding Conditional Control to Text-to-Image Diffusion Models
https://arxiv.org/pdf/2302.05543.pdf
</code></pre>">Adding Conditional Control to Text-to-Image Diffusion Models
https://arxiv.org/pdf/2302.05543.pdf
</code></pre><h4 id="3.2.4-imagen"><a name="3.2.4-imagen" href="#3.2.4-imagen"></a>3.2.4 Imagen</h4><pre><code data-origin="<pre><code>Photorealistic Text-to-Image Diffusion Models with Deep Language Understanding
https://arxiv.org/pdf/2205.11487.pdf
</code></pre>">Photorealistic Text-to-Image Diffusion Models with Deep Language Understanding
https://arxiv.org/pdf/2205.11487.pdf
</code></pre><h4 id="3.2.5-dreambooth"><a name="3.2.5-dreambooth" href="#3.2.5-dreambooth"></a>3.2.5 Dreambooth</h4><pre><code data-origin="<pre><code>https://arxiv.org/pdf/2208.12242.pdf
</code></pre>">https://arxiv.org/pdf/2208.12242.pdf
</code></pre><h2 id="4-分布式训练"><a name="4-分布式训练" href="#4-分布式训练"></a>4 分布式训练</h2><h3 id="4.1-概述"><a name="4.1-概述" href="#4.1-概述"></a>4.1 概述</h3><h3 id="4.2-并行策略"><a name="4.2-并行策略" href="#4.2-并行策略"></a>4.2 并行策略</h3><h4 id="4.2.1-数据并行"><a name="4.2.1-数据并行" href="#4.2.1-数据并行"></a>4.2.1 数据并行</h4><h4 id="4.2.1-模型并行"><a name="4.2.1-模型并行" href="#4.2.1-模型并行"></a>4.2.1 模型并行</h4><h4 id="4.2.1-张量并行"><a name="4.2.1-张量并行" href="#4.2.1-张量并行"></a>4.2.1 张量并行</h4><h3 id="4.3-deepspeed"><a name="4.3-deepspeed" href="#4.3-deepspeed"></a>4.3 DeepSpeed</h3><h2 id="5-大模型应用框架"><a name="5-大模型应用框架" href="#5-大模型应用框架"></a>5 大模型应用框架</h2><h2 id="6-nlp-任务"><a name="6-nlp-任务" href="#6-nlp-任务"></a>6 NLP 任务</h2><h2 id="7-视觉"><a name="7-视觉" href="#7-视觉"></a>7 视觉</h2>

<footer style="position:fixed; font-size:.8em; text-align:right; bottom:0px; margin-left:-25px; height:20px; width:100%;">generated by <a href="http://pad.haroopress.com" target="_blank">haroopad</a></footer>
</body>
</html>
